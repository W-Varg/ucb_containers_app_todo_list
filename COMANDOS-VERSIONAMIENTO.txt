╔═══════════════════════════════════════════════════════════════════════╗
║                                                                       ║
║          COMANDOS RÁPIDOS DE VERSIONAMIENTO - TODO APP               ║
║                                                                       ║
╚═══════════════════════════════════════════════════════════════════════╝

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📦 COMANDOS PARA CREAR Y SUBIR VERSIONES
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# VERSIÓN 1.0.1
./build-and-push.sh 1.0.1
# Cuando pregunte, responder: s

# VERSIÓN 1.0.2
./build-and-push.sh 1.0.2
# Responder: s

# VERSIÓN 1.0.3
./build-and-push.sh 1.0.3
# Responder: s

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

 COMANDOS PARA ACTUALIZAR EN KUBERNETES
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# Actualizar a versión 1.0.1
kubectl set image deployment/backend backend=kryshor/todo-backend:1.0.1 -n todo-app

# Actualizar a versión 1.0.2
kubectl set image deployment/backend backend=kryshor/todo-backend:1.0.2 -n todo-app

# Actualizar a versión 1.0.3
kubectl set image deployment/backend backend=kryshor/todo-backend:1.0.3 -n todo-app

# Ver estado del rollout
kubectl rollout status deployment backend -n todo-app

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

↩️  COMANDOS PARA HACER ROLLBACK
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# Volver a la versión anterior
kubectl rollout undo deployment backend -n todo-app

# Volver a una revisión específica
kubectl rollout undo deployment backend -n todo-app --to-revision=2

# Volver a versión 1.0.1 (específica)
kubectl set image deployment/backend backend=kryshor/todo-backend:1.0.1 -n todo-app

# Volver a versión 1.0.2 (específica)
kubectl set image deployment/backend backend=kryshor/todo-backend:1.0.2 -n todo-app

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🔍 COMANDOS PARA VERIFICAR
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# Ver imágenes locales
docker images kryshor/todo-backend

# Ver pods en Kubernetes
kubectl get pods -n todo-app -l app=backend

# Ver qué versión está corriendo
kubectl describe deployment backend -n todo-app | grep Image

# Ver historial de deployments
kubectl rollout history deployment backend -n todo-app

# Ver detalles de una revisión
kubectl rollout history deployment backend -n todo-app --revision=2

# Ver log de versiones
cat version-history.log

# Probar la API
curl http://localhost:9500/health

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

FLUJO COMPLETO DE TRABAJO
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. Hacer cambio en el código:
   vim backend/server.js

2. Construir y subir versión:
   ./build-and-push.sh 1.0.X

3. Actualizar en Kubernetes:
   kubectl set image deployment/backend backend=kryshor/todo-backend:1.0.X -n todo-app

4. Verificar:
   kubectl rollout status deployment backend -n todo-app
   kubectl get pods -n todo-app -l app=backend

5. Si algo falla, hacer rollback:
   kubectl rollout undo deployment backend -n todo-app

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📦 TAGS QUE SE CREAN AUTOMÁTICAMENTE
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Para cada versión (ejemplo 1.0.1) se crean 3 tags:

  • kryshor/todo-backend:1.0.1  (versión específica)
  • kryshor/todo-backend:1.0    (versión minor)
  • kryshor/todo-backend:latest (última estable)

Todos se suben automáticamente a Docker Hub.

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🔗 ENLACES ÚTILES
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Docker Hub: https://hub.docker.com/r/kryshor/todo-backend/tags

Documentación:
  • GUIA-VERSIONAMIENTO.md - Guía completa
  • INICIO-VERSIONAMIENTO.md - Inicio rápido
  • CHANGELOG.md - Historial de cambios
  • ejemplo-versionamiento.sh - Demo interactiva

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Universidad Católica Boliviana (UCB) - 2025
